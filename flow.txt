COLLECTION OVERVIEW
/users
/contents
/technologies
/topics
/userActivity

1ï¸âƒ£ contents (Single Source of Truth)

This holds every content item (draft, published, starred, etc).

contents (collection)
â””â”€â”€ contentId (document)
    â”œâ”€â”€ title: "Understanding NgRx Effects"
    â”œâ”€â”€ body: "<html or markdown>"
    â”œâ”€â”€ technologyId: "angular"
    â”œâ”€â”€ topicId: "ngrx"
    â”œâ”€â”€ authorId: "user_123"
    â”œâ”€â”€ status: "draft" | "published"
    â”œâ”€â”€ createdAt: Timestamp
    â”œâ”€â”€ updatedAt: Timestamp
    â”œâ”€â”€ publishedAt: Timestamp | null
    â”œâ”€â”€ isDeleted: false

    âœ… Why this works

Draft â†’ Published = just update status

All screens react automatically

Deleting removes it from everywhere

2ï¸âƒ£ technologies (Sidebar â€“ Level 1)
technologies
â””â”€â”€ angular
    â”œâ”€â”€ name: "Angular"
    â”œâ”€â”€ icon: "article"
    â”œâ”€â”€ order: 1

3ï¸âƒ£ topics (Sidebar â€“ Level 2)
topics
â””â”€â”€ ngrx
    â”œâ”€â”€ name: "NgRx"
    â”œâ”€â”€ technologyId: "angular"
    â”œâ”€â”€ order: 1


âš ï¸ Do NOT store content IDs here
We query contents by technologyId + topicId.

4ï¸âƒ£ userActivity (For You / Starred / Recent)

This is user-specific, lightweight metadata.

userActivity
â””â”€â”€ user_123
    â”œâ”€â”€ starred: {
    â”‚     contentId1: true,
    â”‚     contentId2: true
    â”‚   }
    â”œâ”€â”€ recentlyVisited: {
    â”‚     contentId1: Timestamp,
    â”‚     contentId2: Timestamp
    â”‚   }

ğŸ§  SCREEN-WISE DATA STRATEGY
ğŸ  1. For You Screen

Logic

Recently visited

Plus latest published content

Query 1 â€“ Recently Visited
const recentIds = Object.keys(userActivity.recentlyVisited);

Query 2 â€“ Latest Published
query(
  collection(db, 'contents'),
  where('status', '==', 'published'),
  orderBy('publishedAt', 'desc'),
  limit(10)
)

ğŸ•’ 2. Recent Screen (Published Only)
query(
  collection(db, 'contents'),
  where('status', '==', 'published'),
  orderBy('publishedAt', 'desc')
)

â­ 3. Starred Screen

Fetch starred IDs from userActivity

Query contents by IDs

query(
  collection(db, 'contents'),
  where(documentId(), 'in', starredIds)
)


ğŸ’¡ If starred list > 10, paginate IDs

ğŸ“ 4. Drafts Screen
query(
  collection(db, 'contents'),
  where('authorId', '==', userId),
  where('status', '==', 'draft')
)

Publish Draft (Single Update)
updateDoc(doc(db, 'contents', contentId), {
  status: 'published',
  publishedAt: serverTimestamp(),
  updatedAt: serverTimestamp()
});


ğŸ”¥ Automatically:

Removed from drafts

Appears in Recent

Appears in For You

ğŸ“‚ 5. Content Folder (Technology â†’ Topic â†’ Content)
Sidebar
technologies â†’ topics

Content List
query(
  collection(db, 'contents'),
  where('technologyId', '==', 'angular'),
  where('topicId', '==', 'ngrx'),
  where('status', '==', 'published')
)

ğŸ—‘ï¸ DELETE LOGIC (Deletes Everywhere)
Delete Content
deleteDoc(doc(db, 'contents', contentId));

Cleanup User Activity (Cloud Function)
exports.cleanupContent = onDelete(
  firestore.document('contents/{contentId}'),
  async (snap, context) => {
    const contentId = context.params.contentId;
    // remove from starred & recent
  }
);


âœ” Removed from:

For You

Recent

Starred

Content tree  
